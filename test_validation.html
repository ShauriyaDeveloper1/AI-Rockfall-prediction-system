<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Validation Test - AI Rockfall Prediction System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .validation-demo {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        .progress {
            height: 4px;
            border-radius: 2px;
        }
        .strength-indicator {
            transition: all 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container-fluid py-5">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="validation-demo p-5">
                    <div class="text-center mb-5">
                        <h1 class="display-4 mb-3">
                            <i class="fas fa-mountain text-primary me-3"></i>
                            Enhanced Validation Demo
                        </h1>
                        <p class="lead text-muted">
                            AI Rockfall Prediction System - Registration Validation Features
                        </p>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <h3 class="mb-4">
                                <i class="fas fa-user-plus text-success me-2"></i>
                                Registration Form
                            </h3>
                            
                            <form id="registrationForm">
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label class="form-label">First Name</label>
                                        <input
                                            type="text"
                                            class="form-control"
                                            id="firstName"
                                            placeholder="Enter first name"
                                            required
                                        />
                                        <div class="feedback"></div>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Last Name</label>
                                        <input
                                            type="text"
                                            class="form-control"
                                            id="lastName"
                                            placeholder="Enter last name"
                                            required
                                        />
                                        <div class="feedback"></div>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">Email Address</label>
                                    <input
                                        type="email"
                                        class="form-control"
                                        id="email"
                                        placeholder="example@domain.com"
                                        required
                                    />
                                    <div class="feedback"></div>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">Password</label>
                                    <input
                                        type="password"
                                        class="form-control"
                                        id="password"
                                        placeholder="Create a strong password"
                                        required
                                    />
                                    
                                    <!-- Password Strength Indicator -->
                                    <div class="mt-2">
                                        <div class="d-flex justify-content-between align-items-center mb-1">
                                            <small class="text-muted">Password Strength:</small>
                                            <small id="strengthText" class="strength-indicator fw-bold">Very Weak</small>
                                        </div>
                                        <div class="progress">
                                            <div id="strengthBar" class="progress-bar" style="width: 0%"></div>
                                        </div>
                                    </div>

                                    <div id="passwordRequirements" class="mt-2">
                                        <small class="text-muted">Password must include:</small>
                                        <ul class="list-unstyled mt-1 mb-0">
                                            <li class="small text-danger" id="req-length">
                                                <i class="fas fa-times me-1"></i>At least 8 characters long
                                            </li>
                                            <li class="small text-danger" id="req-uppercase">
                                                <i class="fas fa-times me-1"></i>One uppercase letter
                                            </li>
                                            <li class="small text-danger" id="req-lowercase">
                                                <i class="fas fa-times me-1"></i>One lowercase letter
                                            </li>
                                            <li class="small text-danger" id="req-number">
                                                <i class="fas fa-times me-1"></i>One number
                                            </li>
                                            <li class="small text-danger" id="req-special">
                                                <i class="fas fa-times me-1"></i>One special character
                                            </li>
                                        </ul>
                                    </div>
                                </div>

                                <button type="submit" class="btn btn-primary w-100 py-2" id="submitBtn" disabled>
                                    <i class="fas fa-user-plus me-2"></i>
                                    Create Account
                                </button>
                            </form>
                        </div>

                        <div class="col-md-6">
                            <h3 class="mb-4">
                                <i class="fas fa-map-marked-alt text-info me-2"></i>
                                Location Selection Demo
                            </h3>
                            
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="card-title">Risk Map Location Features</h5>
                                    
                                    <!-- Location Search -->
                                    <div class="mb-3">
                                        <label class="form-label">Search Location</label>
                                        <div class="input-group">
                                            <input
                                                type="text"
                                                class="form-control"
                                                id="locationSearch"
                                                placeholder="Search for a location..."
                                            />
                                            <button class="btn btn-outline-secondary" type="button" id="searchBtn">
                                                <i class="fas fa-search"></i>
                                            </button>
                                        </div>
                                        <div id="searchResults" class="mt-2"></div>
                                    </div>

                                    <!-- Coordinate Input -->
                                    <div class="row mb-3">
                                        <div class="col-md-6">
                                            <label class="form-label">Latitude</label>
                                            <input
                                                type="number"
                                                class="form-control"
                                                id="latitude"
                                                placeholder="40.7128"
                                                step="any"
                                            />
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Longitude</label>
                                            <input
                                                type="number"
                                                class="form-control"
                                                id="longitude"
                                                placeholder="-74.0060"
                                                step="any"
                                            />
                                        </div>
                                    </div>

                                    <!-- Geolocation -->
                                    <div class="d-grid gap-2">
                                        <button class="btn btn-success" id="getCurrentLocation">
                                            <i class="fas fa-location-crosshairs me-2"></i>
                                            Get Current Location
                                        </button>
                                        <button class="btn btn-info" id="setLocation">
                                            <i class="fas fa-map-pin me-2"></i>
                                            Set Map Location
                                        </button>
                                    </div>

                                    <div id="locationInfo" class="mt-3 alert alert-info d-none">
                                        <strong>Selected Location:</strong><br>
                                        <span id="selectedLocation">No location selected</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-5">
                        <div class="col-12">
                            <div class="alert alert-success">
                                <h5><i class="fas fa-check-circle me-2"></i>Enhanced Features Implemented:</h5>
                                <ul class="mb-0">
                                    <li><strong>Email Domain Validation:</strong> DNS-based verification of email domains</li>
                                    <li><strong>Password Strength:</strong> Real-time validation with visual feedback</li>
                                    <li><strong>Location Selection:</strong> Click, search, coordinates, and geolocation support</li>
                                    <li><strong>Real-time Feedback:</strong> Instant validation with visual indicators</li>
                                    <li><strong>User Experience:</strong> Professional UI with Bootstrap styling</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Email validation function
        function validateEmail(email) {
            const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
            if (!email) return { valid: false, message: '' };
            if (!emailRegex.test(email)) return { valid: false, message: 'Invalid email format' };
            
            const domain = email.split('@')[1];
            const commonDomains = ['gmail.com', 'yahoo.com', 'hotmail.com', 'outlook.com', 'aol.com', 'icloud.com'];
            const isCommonDomain = commonDomains.includes(domain.toLowerCase());
            
            return { 
                valid: true, 
                message: isCommonDomain ? 'Valid email' : 'Email format correct (domain verified in backend)'
            };
        }

        // Password validation function
        function validatePassword(password) {
            const requirements = {
                length: password.length >= 8,
                uppercase: /[A-Z]/.test(password),
                lowercase: /[a-z]/.test(password),
                number: /\d/.test(password),
                special: /[!@#$%^&*(),.?":{}|<>]/.test(password)
            };

            const score = Object.values(requirements).filter(Boolean).length;
            return { requirements, score };
        }

        // Name validation function
        function validateName(name) {
            if (!name) return { valid: false, message: '' };
            if (name.length < 2) return { valid: false, message: 'Must be at least 2 characters' };
            if (name.length > 50) return { valid: false, message: 'Must be less than 50 characters' };
            if (!/^[a-zA-Z\s\-']+$/.test(name)) return { valid: false, message: 'Only letters, spaces, hyphens, and apostrophes allowed' };
            return { valid: true, message: 'Valid name' };
        }

        // Update validation feedback
        function updateValidationFeedback(element, validation) {
            const feedbackDiv = element.nextElementSibling;
            const input = element;

            if (validation.valid) {
                input.classList.remove('is-invalid');
                input.classList.add('is-valid');
                feedbackDiv.innerHTML = `<div class="valid-feedback d-block">${validation.message}</div>`;
            } else if (validation.message) {
                input.classList.remove('is-valid');
                input.classList.add('is-invalid');
                feedbackDiv.innerHTML = `<div class="invalid-feedback d-block">${validation.message}</div>`;
            } else {
                input.classList.remove('is-valid', 'is-invalid');
                feedbackDiv.innerHTML = '';
            }
        }

        // Password strength colors and text
        function getPasswordStrengthColor(score) {
            const colors = ['#dc3545', '#fd7e14', '#ffc107', '#28a745', '#20c997'];
            return colors[score - 1] || '#6c757d';
        }

        function getPasswordStrengthText(score) {
            const texts = ['Very Weak', 'Weak', 'Fair', 'Good', 'Strong'];
            return texts[score - 1] || 'Very Weak';
        }

        // Event listeners
        document.getElementById('firstName').addEventListener('input', function(e) {
            const validation = validateName(e.target.value);
            updateValidationFeedback(e.target, validation);
            checkFormValidity();
        });

        document.getElementById('lastName').addEventListener('input', function(e) {
            const validation = validateName(e.target.value);
            updateValidationFeedback(e.target, validation);
            checkFormValidity();
        });

        document.getElementById('email').addEventListener('input', function(e) {
            const validation = validateEmail(e.target.value);
            updateValidationFeedback(e.target, validation);
            checkFormValidity();
        });

        document.getElementById('password').addEventListener('input', function(e) {
            const password = e.target.value;
            const validation = validatePassword(password);
            
            // Update strength indicator
            const strengthBar = document.getElementById('strengthBar');
            const strengthText = document.getElementById('strengthText');
            const color = getPasswordStrengthColor(validation.score);
            
            strengthBar.style.width = `${(validation.score / 5) * 100}%`;
            strengthBar.style.backgroundColor = color;
            strengthText.textContent = getPasswordStrengthText(validation.score);
            strengthText.style.color = color;

            // Update requirements
            Object.keys(validation.requirements).forEach(req => {
                const element = document.getElementById(`req-${req}`);
                const icon = element.querySelector('i');
                if (validation.requirements[req]) {
                    element.classList.remove('text-danger');
                    element.classList.add('text-success');
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-check');
                } else {
                    element.classList.remove('text-success');
                    element.classList.add('text-danger');
                    icon.classList.remove('fa-check');
                    icon.classList.add('fa-times');
                }
            });

            checkFormValidity();
        });

        function checkFormValidity() {
            const firstName = document.getElementById('firstName').value;
            const lastName = document.getElementById('lastName').value;
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            const validations = {
                firstName: validateName(firstName),
                lastName: validateName(lastName),
                email: validateEmail(email),
                password: validatePassword(password)
            };

            const allValid = validations.firstName.valid && 
                           validations.lastName.valid && 
                           validations.email.valid && 
                           validations.password.score >= 4;

            document.getElementById('submitBtn').disabled = !allValid;
        }

        // Location features
        document.getElementById('getCurrentLocation').addEventListener('click', function() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    
                    document.getElementById('latitude').value = lat.toFixed(6);
                    document.getElementById('longitude').value = lng.toFixed(6);
                    
                    showLocationInfo(`Current Location: ${lat.toFixed(6)}, ${lng.toFixed(6)}`);
                });
            } else {
                alert('Geolocation is not supported by this browser.');
            }
        });

        document.getElementById('searchBtn').addEventListener('click', function() {
            const query = document.getElementById('locationSearch').value;
            if (query) {
                // Simulate search results
                const results = [
                    { name: `${query} - Location 1`, lat: 40.7128, lng: -74.0060 },
                    { name: `${query} - Location 2`, lat: 34.0522, lng: -118.2437 },
                    { name: `${query} - Location 3`, lat: 51.5074, lng: -0.1278 }
                ];
                
                const resultsDiv = document.getElementById('searchResults');
                resultsDiv.innerHTML = results.map(result => 
                    `<button class="btn btn-sm btn-outline-primary me-2 mb-1" onclick="selectLocation(${result.lat}, ${result.lng}, '${result.name}')">
                        ${result.name}
                    </button>`
                ).join('');
            }
        });

        document.getElementById('setLocation').addEventListener('click', function() {
            const lat = document.getElementById('latitude').value;
            const lng = document.getElementById('longitude').value;
            
            if (lat && lng) {
                showLocationInfo(`Set Location: ${lat}, ${lng}`);
            } else {
                alert('Please enter valid coordinates');
            }
        });

        function selectLocation(lat, lng, name) {
            document.getElementById('latitude').value = lat;
            document.getElementById('longitude').value = lng;
            showLocationInfo(`Selected: ${name} (${lat}, ${lng})`);
        }

        function showLocationInfo(text) {
            const infoDiv = document.getElementById('locationInfo');
            const locationText = document.getElementById('selectedLocation');
            locationText.textContent = text;
            infoDiv.classList.remove('d-none');
        }

        // Form submission
        document.getElementById('registrationForm').addEventListener('submit', function(e) {
            e.preventDefault();
            alert('Registration form submitted! All validations passed.');
        });
    </script>
</body>
</html>